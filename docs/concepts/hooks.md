### Hooks

A Hook is like a code you can add to your template. You can plug it in at a specific moment in the generation process. Hooks are the functions which are called by the Generator itself. Hooks can be used in many ways, You can have a code that executes after the generation. For example, generating some diagrams after the execution is done. The Hooks code will instruct the template to generate diagrams based on the code instructions.
Moreover, theese allow us to use reusable hooks. You can have your own npm package with a number hooks that anyone can use in their code. For example, A hook that generates pdf files using a npm library. 
Hooks can be anonymous functions but you can also add function names. These hooks can have arguments provided to them or be expected to return a value. The following types of hooks are currently supported:

|Hook type|Description| Return type | Arguments 
|---|---|---|---|
| `generate:before` | Called after registration of all filters and before generator starts processing of the template. | void : Nothing is expected to be returned. | [The generator instance](https://github.com/asyncapi/generator/blob/master/docs/api.md)
| `generate:after` | Called at the very end of the generation. | void : Nothing is expected to be returned. | [The generator instance](https://github.com/asyncapi/generator/blob/master/docs/api.md)
| `setFileTemplateName ` | Called right before saving a new file generated by [file template](https://github.com/asyncapi/generator/blob/master/docs/authoring.md#file-templates). | string : a new filename for the generator to use for the file template. | [The generator instance](https://github.com/asyncapi/generator/blob/master/docs/api.md) and object in the form of `{ "originalFilename" : string }`

The generator parses:

- All the files in the .hooks directory inside the template.
- All modules listed in the template configuration and triggers only hooks that names were added to the config. You can use the official AsyncAPI [hooks library](https://github.com/asyncapi/generator-hooks). To learn how to add hooks to configuration [read more about the configuration file](https://github.com/pratik2315/generator/blob/gsod1-pratik/docs/authoring.md#configuration-file).

Most basic module with hooks looke like this:
```js
module.exports = {
  'generate:after': generator => console.log('This runs after generation is complete')
}
```

Below you have an example Hook that after generation creates pdfs and svg files. This particular Hook is taken from the AsyncAPI [template-for-template-generator](https://github.com/asyncapi/template-for-generator-templates) repostiory. 

```js
const puppeteer = require('puppeteer');
const path = require('path');

if (parameters.pdf === 'true') await page.pdf({ format: 'A4', path: `${targetDir}/index.pdf` });

  if (parameters.png === 'true') {
    const clip = await page.$eval('.mermaid', svg => {
      const react = svg.getBoundingClientRect();
      return { x: Math.floor(react.left), y: Math.floor(react.top), width: Math.ceil(react.width), height: Math.ceil(react.height) };
    });
    await page.setViewport({ width: clip.x + clip.width, height: clip.y + clip.height });
    await page.screenshot({ path: `${targetDir}/index.png`, clip});
  }

  if (parameters.svg === 'true') {
    const svg = await page.$eval('.mermaid', container => container.innerHTML);
    fs.writeFileSync(`${targetDir}/index.svg`, svg);
  }

  browser.close();
```
Below you have an example Hook that after generation creates an AsyncAPI file.

```js
const fs = require('fs');
const path = require('path');

module.exports = {
  'generate:after': generator => {
    const asyncapi = generator.originalAsyncAPI;
    let extension;

    try {
      JSON.parse(asyncapi);
      extension = 'json';
    } catch (e) {
      extension = 'yaml';
    }

    fs.writeFileSync(path.resolve(generator.targetDir, `asyncapi.${extension}`), asyncapi);
  }
};
```

The following Hook removes Non-relevant files from the [Java Spring template](https://github.com/asyncapi/java-spring-template) after generation

```js
const fs = require('fs');
const path = require('path');

module.exports = {
    'generate:after': generator => {
        let hasMqtt, hasAmqp, hasKafka;
        const asyncapi = generator.asyncapi;
        for (let server of Object.values(asyncapi.servers())) {
            hasAmqp = hasAmqp || server.protocol() === 'amqp';
            hasMqtt = hasMqtt || server.protocol() === 'mqtt';
            hasKafka = hasKafka || server.protocol() === 'kafka' || server.protocol() === 'kafka-secure';
        }
        if (!hasKafka) {
            fs.unlinkSync(path.resolve(generator.targetDir, 'src/test/java/com/asyncapi/SimpleKafkaTest.java'));
            fs.unlinkSync(path.resolve(generator.targetDir, 'src/test/java/com/asyncapi/TestcontainerKafkaTest.java'));
        }
        if (!hasAmqp) {
        }
        if (!hasMqtt) {
            fs.unlinkSync(path.resolve(generator.targetDir, 'src/test/java/com/asyncapi/TestcontainerMqttTest.java'));
        }
    }
};
```