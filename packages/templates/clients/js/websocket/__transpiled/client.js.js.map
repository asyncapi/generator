{"version":3,"file":"client.js.js","sources":["../helpers/utils.js","../helpers/servers.js","../components/FileHeaderInfo.js","../components/Requires.js","../template/client.js.js"],"sourcesContent":["/**\n * Get client name from AsyncAPI info.title\n *\n * @param {object} info - The AsyncAPI info object.\n * \n * return {string} - The client name with \"Client\" appended at the end.\n */\nfunction getClientName(info) {\n  const title = info.title();\n  \n  // Remove spaces, make the first letter uppercase, and add \"Client\" at the end\n  return `${title.replace(/\\s+/g, '') // Remove all spaces\n    .replace(/^./, char => char.toUpperCase()) // Make the first letter uppercase\n  }Client`;\n};\n\nexport { getClientName };\n  ","/**\n   * Get server URL from AsyncAPI server object.\n   *\n   * @param {object} server - The AsyncAPI server object.\n   * \n   * return {string} - The server URL.\n   */\nfunction getServerUrl(server) {\n  let url = server.host();\n\n  //might be that somebody by mistake duplicated protocol info inside the host field\n  //we need to make sure host do not hold protocol info\n  if (server.protocol() && !url.includes(server.protocol())) {\n    url = `${server.protocol()}://${url}`;\n  }\n    \n  if (server.hasPathname()) {\n    url = `${url}${server.pathname()}`;\n  }\n    \n  return url;\n}\n\n//TODO: this separate file for helpers for servers represents approach to keep all helpers in separate files related to extractions of data from specific high level AsyncAPI objects. Here we will have more helpers for example related to variables extraction from servers, security, etc.\n  \nexport { getServerUrl };\n    ","import { Text } from '@asyncapi/generator-react-sdk';\n\nexport function FileHeaderInfo({ info, server }) {\n  return (\n    <Text>\n      <Text>\n        {'//////////////////////////////////////////////////////////////////////'}\n      </Text>\n      \n      <Text>\n        {'//'}\n      </Text>\n\n      <Text>\n        {'//'} {info.title()} - {info.version()}\n      </Text>\n\n      <Text>\n        {'//'} Protocol: {server.protocol()}\n      </Text>\n\n      <Text>\n        {'//'} Host: {server.host()}\n      </Text>\n\n      {server.hasPathname() && (\n        <Text>\n          {'//'} Path: {server.pathname()}\n        </Text>\n      )}\n\n      <Text>\n        {'//'}\n      </Text>\n\n      <Text>\n        {'//////////////////////////////////////////////////////////////////////'}\n      </Text>\n    </Text>\n  );\n}","import { Text } from '@asyncapi/generator-react-sdk';\n\nexport function Requires() {\n  return (\n    <Text>\n      <Text>\n        const WebSocket = require('ws');\n      </Text>\n    </Text>\n  );\n}\n\n","import { File, Text } from '@asyncapi/generator-react-sdk';\nimport { getClientName } from '../helpers/utils';\nimport { getServerUrl } from '../helpers/servers';\nimport { FileHeaderInfo }  from '../components/FileHeaderInfo';\nimport { Requires } from '../components/Requires';\n\nexport default function({ asyncapi, params }) {\n  const server = asyncapi.servers().get(params.server);\n  const info = asyncapi.info();\n  const title = info.title();\n  //TODO at this moment this template shows usage of granular components and also generic Text component with lots of code but also not so nice to read. We need to figure the best way of handling this.\n  return (\n    <File name={params.clientFileName}>\n      <FileHeaderInfo\n        info={info}\n        server={server}\n      />\n      <Requires/>\n      <Text>\n        {`class ${getClientName(info)} {\n  constructor() {\n    this.url = '${getServerUrl(server)}';\n    this.websocket = null;\n    this.messageHandlers = [];\n    this.errorHandlers = [];\n  }\n\n  // Method to establish a WebSocket connection\n  connect() {\n    return new Promise((resolve, reject) => {\n      this.websocket = new WebSocket(this.url);\n\n      // On successful connection\n      this.websocket.onopen = () => {\n        console.log('Connected to ${title} server');\n        resolve();\n      };\n\n      // On receiving a message\n      this.websocket.onmessage = (event) => {\n        console.log('Message received:', event.data);\n\n        this.messageHandlers.forEach(handler => {\n          if (typeof handler === 'function') {\n            this.handleMessage(event.data, handler);\n          }\n        });\n      };\n\n      // On error first call custom error handlers, then default error behavior\n      this.websocket.onerror = (error) => {\n        if (this.errorHandlers.length > 0) {\n          // Call custom error handlers\n          this.errorHandlers.forEach(handler => handler(error));\n        } else {\n          // Default error behavior\n          console.error('WebSocket Error:', error);\n        }\n        reject(error);\n      };\n\n      // On connection close\n      this.websocket.onclose = () => {\n        console.log('Disconnected from ${title} server');\n      };\n    });\n  }\n\n  // Method to register custom error handlers\n  registerMessageHandler(handler) {\n    if (typeof handler === 'function') {\n      this.messageHandlers.push(handler);\n    } else {\n      console.warn('Message handler must be a function');\n    }\n  }\n\n  // Method to register custom error handlers\n  registerErrorHandler(handler) {\n    if (typeof handler === 'function') {\n      this.errorHandlers.push(handler);\n    } else {\n      console.warn('Error handler must be a function');\n    }\n  }\n\n  // Method to handle message with callback\n  handleMessage(message, cb) {\n    if (cb) cb(message);\n  }\n\n  // Method to send an echo message to the server\n  sendEchoMessage(message) {\n    this.websocket.send(JSON.stringify(message));\n    console.log('Sent message to echo server:', message);\n  }\n\n  // Method to close the WebSocket connection\n  close() {\n    if (this.websocket) {\n      this.websocket.close();\n      console.log('WebSocket connection closed.');\n    }\n  }\n}\n\nmodule.exports = ${getClientName(info)};`}\n      </Text>\n    </File>);\n}"],"names":["getClientName","info","title","replace","char","toUpperCase","getServerUrl","server","url","host","protocol","includes","hasPathname","pathname","FileHeaderInfo","_jsxs","Text","children","_jsx","version","Requires","asyncapi","params","servers","get","File","name","clientFileName"],"mappings":"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C,MAAAA,QAAA,EACF,CAAA,MAAA,EAASjB,aAAa,CAACC,IAAI,CAAC,CAAA;AACrC;AACA,gBAAkBK,EAAAA,YAAY,CAACC,MAAM,CAAC,CAAA;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAA,EAAoCL,KAAK,CAAA;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAA,EAAyCA,KAAK,CAAA;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAmBF,EAAAA,aAAa,CAACC,IAAI,CAAC,CAAA,CAAA,CAAA;AAAG,KAC7B,CAAC,CAAA;AAAA,GACH,CAAC,CAAA;AACX;;;;"}